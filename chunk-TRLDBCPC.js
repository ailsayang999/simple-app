import{O as n,ga as a}from"./chunk-SMBC5H4O.js";var l=(s=>(s.Admin="ADMIN",s.Manager="MANAGER",s.ReportViewer="REPORT_VIEWER",s.User="USER",s))(l||{}),g=(s=>(s.FundRead="fund.read",s.FundWrite="fund.write",s.ProductView="product.view",s.ProductEdit="product.edit",s))(g||{}),u={ADMIN:["fund.read","fund.write","product.view","product.edit"],MANAGER:["fund.read","product.view","product.edit"],REPORT_VIEWER:["fund.read","product.view"],USER:[]};var d=class o{TOKEN_KEY="demo_token";USER_KEY="demo_user";userSignal=a(this.loadUser());loadUser(){let e=localStorage.getItem(this.USER_KEY);return e?JSON.parse(e):null}isLoggedIn(){return!!localStorage.getItem(this.TOKEN_KEY)}hasRole(e){let r=this.userSignal();return!!r&&r.roles.includes(e)}hasAnyRole(e){let r=this.userSignal();return r?e.some(t=>r.roles.includes(t)):!1}hasPermission(e){let r=this.userSignal();return!!r&&r.permissions.includes(e)}hasAnyPermission(e){let r=this.userSignal();return r?e.some(t=>r.permissions.includes(t)):!1}login(e,r){let t="FAKE_JWT_TOKEN",s=["USER"];e==="admin@test.com"?s=["ADMIN"]:e==="manager@test.com"?s=["MANAGER"]:e==="report@test.com"&&(s=["REPORT_VIEWER"]);let m=Array.from(new Set(s.flatMap(c=>u[c]??[]))),i={id:"1",name:"John Doe",email:e,avatarUrl:"https://i.pravatar.cc/100?img=8",roles:s,permissions:m};return localStorage.setItem(this.TOKEN_KEY,t),localStorage.setItem(this.USER_KEY,JSON.stringify(i)),this.userSignal.set(i),!0}register(e,r,t){return this.login(r,t)}logout(){localStorage.removeItem(this.TOKEN_KEY),localStorage.removeItem(this.USER_KEY),this.userSignal.set(null)}static \u0275fac=function(r){return new(r||o)};static \u0275prov=n({token:o,factory:o.\u0275fac,providedIn:"root"})};export{l as a,g as b,d as c};
