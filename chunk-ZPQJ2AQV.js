import{O as i,ga as a}from"./chunk-SMBC5H4O.js";var l=(e=>(e.Admin="ADMIN",e.Manager="MANAGER",e.ReportViewer="REPORT_VIEWER",e.User="USER",e))(l||{}),g=(e=>(e.FundRead="fund.read",e.FundWrite="fund.write",e.ProductView="product.view",e.ProductEdit="product.edit",e))(g||{}),u={ADMIN:["fund.read","fund.write","product.view","product.edit"],MANAGER:["fund.read","product.view","product.edit"],REPORT_VIEWER:["fund.read","product.view"],USER:[]};var d=class t{TOKEN_KEY="demo_token";USER_KEY="demo_user";userSignal=a(this.loadUser());loadUser(){let r=localStorage.getItem(this.USER_KEY);return r?JSON.parse(r):null}isLoggedIn(){return!!localStorage.getItem(this.TOKEN_KEY)}hasRole(r){let s=this.userSignal();return!!s&&s.roles.includes(r)}hasAnyRole(r){let s=this.userSignal();return s?r.some(o=>s.roles.includes(o)):!1}hasPermission(r){let s=this.userSignal();return!!s&&s.permissions.includes(r)}hasAnyPermission(r){let s=this.userSignal();return s?r.some(o=>s.permissions.includes(o)):!1}login(r,s){let o="FAKE_JWT_TOKEN",e=[];r==="admin@test.com"?(e=["ADMIN","MANAGER","REPORT_VIEWER","USER"],console.log("roles",e)):r==="manager@test.com"?(e=["MANAGER"],console.log("roles",e)):r==="report@test.com"&&(e=["REPORT_VIEWER"],console.log("roles",e));let c=Array.from(new Set(e.flatMap(m=>u[m]??[]))),n={id:"1",name:"John Doe",email:r,avatarUrl:"https://i.pravatar.cc/100?img=8",roles:e,permissions:c};return localStorage.setItem(this.TOKEN_KEY,o),localStorage.setItem(this.USER_KEY,JSON.stringify(n)),this.userSignal.set(n),!0}register(r,s,o){return this.login(s,o)}logout(){localStorage.removeItem(this.TOKEN_KEY),localStorage.removeItem(this.USER_KEY),this.userSignal.set(null)}static \u0275fac=function(s){return new(s||t)};static \u0275prov=i({token:t,factory:t.\u0275fac,providedIn:"root"})};export{l as a,g as b,d as c};
